{% extends 'base.html' %}
{% block content %}
<div class='overlay'>
  <div id='person'>
  </div>
</div>
<div class='row'>
  <div class='sidebar'>
    <div class='inner'>
      <ul>
        <li><a href='/dashboard'><span></span>New Leads</a></li>
        <li><a class='active' href='/search'><span></span>Search</a></li>
        <li><a href='/clients'><span></span>Your Clients</a></li>
        <li><a href='/investor_profile'><span></span>Your Profile</a></li>
      </ul>
    </div>
  </div>
  <div class='items'>
    <div class='results'>
      <h1>Search</h1>
      <p>Search by school, company, location and dates</p>
      <div class='search-box'>
        <input type="hidden" name="company_id" value="">
        <input type="hidden" name="school_id" value="">
        <div class='fieldset'>
          <label>Search Type:</label>
          <select name='type' id='search-type' class='chosen-select' type='text'>
            <option selected value='1'>School</option>
            <option value='2'>Companies</option>
          </select>
        </div>
        <div class='fieldset'>
          <input type='text' class='form-group' placeholder='Enter In The Name' name='' id='term' />
        </div>
        <div class='fieldset'>
          <button type='submit' id='search-submit' class='btn btn-success'>SEARCH</button>
        </div>
        <div class='clear'></div>
        <div class='search-page-results'></div>
        <div class='clear'></div>
      </div>
      <div class='clear'></div>
    </div>
    <div class='padding'>
      <table class="table table-striped table-hover ">
        <thead>
          <tr>
            <th>Prospect Name</th>
            <th>Relevancy</th>
            <th>Current Location</th>
            <th>Current Industry</th>
            <th>Start Date</th>
            <th>End Date</th>
          </tr>
        </thead>
        <tbody>
        {% if prospects %}
        {% for prospect in prospects %}
        <tr>
          <td><script type="IN/MemberProfile" data-id="{{ prospect.url }}" data-format="hover"></script><a href='javascript:loadProfile({{ prospect.id}});'>{{ prospect.name }}</a></td>
          <td>{{ prospect.relevant_item.name }}</td>
          <td>{{ prospect.location_raw }}</td>
          <td>{{ prospect.industry_raw }}</td>
          <td>{{ prospect.relevant_item.start_date }}</td>
          <td>{{ prospect.relevant_item.end_date }}</td>
        </tr>
        {% endfor %}
        {% endif %}
        </tbody>
      </table>
      <div class='pagination'>
        {% if prospects %}
        <p>{% if prospects.has_prev %}<a href="{{ company.get_url }}?p={{ prospects.prev_num }}"><< Previous Page</a>{% endif %}
        {% if prospects.has_next %}<a href="{{ company.get_url }}?p={{ prospects.next_num }}">Next Page >></a>{% endif %}</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
<script src="/static/js/chart.js" type="text/javascript"></script>
<script src="//platform.linkedin.com/in.js" type="text/javascript"></script>
<script type='text/javascript'>
var searchType;
$(function() {
    $("#search-submit").click(function() {
      searchType = $('#search-type').val();
      if (searchType == 1) {
        searchType = "schools"
      } else {
        searchType = "companys"
      }
      var term = $("#term").val()
      $(".search-page-results").show();
      $(".search-page-results").load("/elastic_search?type=" + searchType +"&term=" + term, function() {
        bindButtons();
      })
    });
});

function bindButtons() {
  $("[data-name]").click(function() {
      var dataId = $(this).data("id");
      var dataName = $(this).data("name")
      if (searchType == "companys") {
        window.location = "/search?company_id=" + dataId;
      } else {
        window.location = "/search?school_id=" + dataId;
      }
  });
}

</script>
{% endblock %}
