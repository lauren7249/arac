{% extends 'base.html' %}
{% block content %}
<div class='overlay'>
  <div id='person'>
  </div>
</div>
<div class='row'>
  <div class='sidebar'>
    <div class='inner'>
      <ul>
        <li><a href='/dashboard'><span></span>New Leads</a></li>
        <li><a class='active' href='/search'><span></span>Search</a></li>
        <li><a href='/clients'><span></span>Your Clients</a></li>
        <li><a href='/investor_profile'><span></span>Your Profile</a></li>
      </ul>
    </div>
  </div>
  <div class='items'>
    <div class='welcome'>
      <h1>Search</h1>
      <p>Search by, person, school, company, location and dates</p>
      <hr />
      <ul class='tabs'>
        <li class='active'><a id='show-school-company' href='javascript:;'>School &amp; Company</a></li>
        <li><a id='show-person' href='javascript:;'>Person</a><li>
      </ul>
    </div>
    <div class='results school-company-search'>
      <div class='search-box'>
        <input type="hidden" name="company_id" value="">
        <input type="hidden" name="school_id" value="">
        <div class='fieldset'>
          <label>Search Type:</label>
          <select name='type' id='search-type' class='chosen-select' type='text'>
            <option selected value='1'>School</option>
            <option value='2'>Companies</option>
          </select>
        </div>
        <div class='fieldset'>
          <input type='text' class='form-group' placeholder='Enter In The Name' name='' id='term' />
        </div>
        <div class='fieldset date'>
          <input type='text' class='datepicker form-group' placeholder='Start Date (optional)' name='start_date' id='term' />
        </div>
        <div class='fieldset date'>
          <input type='text' class='datepicker form-group' placeholder='End Date (optional)' name='end_date' id='term' />
        </div>
        <div class='fieldset date'>
          <button type='submit' id='search-submit' class='btn btn-success'>SEARCH</button>
        </div>
        <div class='clear'></div>
        <h5 class='advanced'><a href='javascript:showFilters();'>Advanced Filters >></a></h5>
        <br />
        <div class='advanced-filters'>
          <div class='fieldset' style='width: 420px;'>
            <label>Filters:</label>
            <input style='width: 350px;' type='text' class='form-group' placeholder='Location' name='' id='term' />
          </div>
          <div class='fieldset date'>
            <input type='text' class='datepicker form-group' placeholder='Current Industry' name='' id='term' />
          </div>
          <div class='fieldset date'>
            <input type='text' class='datepicker form-group' placeholder='Job Title' name='' id='term' />
          </div>
        </div>
        <div class='search-page-results'></div>
        <div class='clear'></div>
      </div>
      <div class='clear'></div>
      <div class='padding'>
        <table class="table table-striped table-hover ">
          <thead>
            {% if prospects %}
            <tr>
              <th>Prospect Name</th>
              <th>Relevancy</th>
              <th>Current Location</th>
              <th>Current Industry</th>
              <th>Start Date</th>
              <th>End Date</th>
            </tr>
          </thead>
          <tbody>
            {% for prospect in prospects %}
          <tr>
            <td><script type="IN/MemberProfile" data-id="{{ prospect.url }}" data-format="hover"></script><a href='javascript:loadProfile({{ prospect.id}});'>{{ prospect.name }}</a></td>
            <td>{{ prospect.relevant_item.name }}</td>
            <td>{{ prospect.location_raw }}</td>
            <td>{{ prospect.industry_raw }}</td>
            <td>{{ prospect.relevant_item.start_date }}</td>
            <td>{{ prospect.relevant_item.end_date }}</td>
          </tr>
          {% endfor %}
          {% else %}
          <tr>
            <td><h2 class='empty'>Search for any group of people based on their work or educational history, and then filter them by industry and location</h2></td>
          </tr>
          {% endif %}
          </tbody>
        </table>
        <div class='pagination'>
          {% if prospects %}
          <p>{% if prospects.has_prev %}<a href="{{ company.get_url }}?p={{ prospects.prev_num }}"><< Previous Page</a>{% endif %}
          {% if prospects.has_next %}<a href="{{ company.get_url }}?p={{ prospects.next_num }}">Next Page >></a>{% endif %}</p>
          {% endif %}
        </div>
      </div>
    </div>
    <div class='results person-search'>
      <div class='search-box'>
        <div class='fieldset' style='width: 500px;'>
          <input type='text' class='form-group' placeholder="Enter in the person's name and school or company" name='' id='term' />
        </div>
        <div class='fieldset date'>
          <button type='submit' id='search-submit' class='btn btn-success'>SEARCH</button>
        </div>
        <div class='clear'></div>
        <div class='search-page-results'></div>
        <div class='clear'></div>
      </div>
      <div class='clear'></div>
    </div>
  </div>
</div>
<link href="/static/css/datepicker.css" rel="stylesheet"></link>
<script src="/static/js/chart.js" type="text/javascript"></script>
<script src="/static/js/chart.js" type="text/javascript"></script>
<script src="/static/js/bootstrap-datepicker.js" type="text/javascript"></script>
<script src="//platform.linkedin.com/in.js" type="text/javascript"></script>
<script type='text/javascript'>
var searchType;
$(function() {
    $("#search-submit").click(function() {
      searchType = $('#search-type').val();
      if (searchType == 1) {
        searchType = "schools"
      } else {
        searchType = "companys"
      }
      var term = $("#term").val()
      $(".search-page-results").show();
      $(".search-page-results").load("/elastic_search?type=" + searchType +"&term=" + term, function() {
        bindButtons();
      })
    });

    $(".datepicker").datepicker();
    bindButtons();
});

function bindButtons() {
  $("[data-name]").click(function() {
      var dataId = $(this).data("id");
      var dataName = $(this).data("name")
      if (searchType == "companys") {
        window.location = "/search?company_id=" + dataId;
      } else {
        window.location = "/search?school_id=" + dataId;
      }
  });

    $("#show-school-company").click(function() {
        $(".person-search").hide();
        $(".school-company-search").fadeIn();
        $(".tabs li").removeClass("active");
        $(this).parent().addClass("active");
    });

    $("#show-person").click(function() {
        $(".school-company-search").hide();
        $(".person-search").fadeIn();
        $(".tabs li").removeClass("active");
        $(this).parent().addClass("active");
    });
}

function showFilters() {
  $(".advanced-filters").slideDown();
  $("h5").hide();
}


</script>
{% endblock %}
