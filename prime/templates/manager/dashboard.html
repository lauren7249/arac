{% extends 'base.html' %}
{% block content %}
<div class='invite-agent'>
  <div class='invite-box'>
    <h4>Enter in email address to invite agent</h4>
    <input type='text' name='first_name' placeholder='John' />
    <input type='text' name='last_name' placeholder='Smith' />
    <input type='text' name='email' placeholder='John_Smith@newyorklife.com' />
    <button id='send' class='button primary big'><i class='fa fa-paper-plane-o'></i> Send Invitation</button><button id='close' class='button danger big'><i class='fa fa-ban'></i> Cancel</button>
  </div>
</div>
  <div class="subheader">
    <div class="wrap">
      <div class="col-4">
        <h2>Manager Dashboard</h2>
      </div>
      <div class="col-8">
        <div class="subnav">
          <ul>
            <li><a href="#" class="selected">Selected Tab</a></li>
            <li><a href="#">Request Hiring Screen</a></li>
            <li><a href="#">Request P200</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <div class="section">
    <div class="wrap"> 
      <table class="manager-dashboard">
        <thead>
          <th>Agent</th>
          <th>Primary Network</th>
          <th>Extended Network</th>
          <th>Total Network</th>
          <th>Avg Income Score</th>
          <th>Avg Age</th>
          <th class="completed">Completed</th>
        </thead>
        <tbody>
        <tr>
        </tr>
        {% if agent_count < 1 %}
        <tr>
          <td colspan='7'><h4>Add some agents to get started!</h4></td>
        </tr>
        {% else %}
        {% for agent in agents %}
        <tr>
          <td class="agent"><span style="background-image:url({{ agent.image_url }})" class="face"></span><span>{{ agent.name }}</span></td>
          <td>64</td>
          <td>720</td>
          <td>784</td>
          <td>48/100</td>
          <td>34</td>
          <td class="completed yes"></td>
        </tr>
        {% endfor %}
        {% endif %}
        </tbody>
      </table>
  </div>
</div>
<script type='text/javascript'>
var csrftoken = "{{ csrf_token() }}"
$(function() {
    $("#send").click(function() {
        var email = $("[name='email']").val();
        var first_name = $("[name='first_name']").val();
        var last_name = $("[name='last_name']").val();
        if (email == '' || first_name == '' || last_name == '') {
          alert("You must fill out all fields");
          return false;
        }
        var data = {csrf_token:csrftoken, 
                  first_name:first_name,
                  last_name:last_name, 
                  email:email}
        $.post("/managers/invite", data, function(data) {
          if (data.error) {
            alert(data.error)
          }
          $(".invite-box").slideUp();
          $(".invite-agent").fadeOut();
      });
    });

    $("#close").click(function() {
        $(".invite-box").slideUp();
        $(".invite-agent").fadeOut();
    });

    $("#invite").click(function() {
          $(".invite-agent").fadeIn();
          $(".invite-box").slideDown();
    });
});
</script>
{% endblock %}
