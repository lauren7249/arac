{% extends 'base.html' %}
{% block content %}
  {% include "_partials/manager_header.html" with context %}
  <div class="section">
    <div class="wrap"> 
      <table class="manager-dashboard">
        <thead>
          <th>Agent</th>
          <th>Primary Network</th>
          <th>Extended Network</th>
          <th>Total Network</th>
          <th>Avg Income Score</th>
          <th>Avg Age</th>
          <th class="completed">Hiring Screen</th>
          <th class="completed">P200</th>
        </thead>
        <tbody>
        <tr>
        </tr>
        {% if agent_count < 1 %}
        <tr>
          <td colspan='7'><h4>Add some agents to get started!</h4></td>
        </tr>
        {% else %}
        {% for agent in agents %}
        <tr>
          <td class="agent"><span style="background-image:url({{ agent.image_url }})" class="face"></span><span>{{ agent.name }}<span class='email'>{{ agent.email }}</span></span></td>
          <td>{% if agent.has_prospects %}{{ '{0:,}'.format(agent.primary_network_size | int) }}{% else %}-{% endif %}</td>
          <td>{% if agent.has_prospects %} {{ '{0:,}'.format(agent.extended_network_size | int) }}{% else %}-{% endif %}</td>
          <td>{% if agent.has_prospects %}{{ '{0:,}'.format(agent.total_network_size | int) }}{% else %}-{% endif %}</td>
          <td>{% if agent.has_prospects %}{{ agent.average_income_score }}{% else %}-{% endif %}</td>
          <td>{% if agent.has_prospects %}{{ agent.average_age }}{% else %}-{% endif %}</td>
          <td data-td='{{ agent.user_id }}' class="completed {% if agent.p200_completed %}yes{% else %}{% endif %}">
            {% if agent.hiring_screen_completed %}
              <a target='_blank' href='/managers/agent/{{ agent.user_id }}'><button class='button teal small'>View</button></a>            
<!--               <button data-p200-id='{{ agent.user_id }}' class='button teal small'>Request P200</button>
              <a target='_blank' href='/managers/agent/{{ agent.user_id }}'><button class='button dark-blue small'>Request</button></a> -->
            {% elif agent.contacts_uploaded > 0 %}
              <span class='pending' data-tooltip='Contacts have been uploaded and the hiring screen will be available within 24 hours.'>In Progress</span>   
            {% else %}
              {% if agent.account_created %}
                <span class='pending' data-tooltip='Account created, no contacts uploaded yet'>Pending</span>   
              {% else %}
                <span class='pending' data-tooltip='Invite sent, response pending'>Requested</span>
              {% endif %}      
            {% endif %}
          </td>
          <td data-td='{{ agent.user_id }}' id='{{ agent.user_id }}_p200_cell' data-tooltip="{% if agent.p200_completed %}Completed (only visible to agent){% elif not agent.hiring_screen_completed %} Not yet available{% endif %}" class="completed {% if agent.p200_completed %}yes{% else %}{% endif %}">
            {% if agent.p200_completed %}
            {% elif agent.p200_started %}
              <span class='pending' data-tooltip='P200 is running and will be available within 24 hours.'>In Progress</span>    
            {% elif agent.hiring_screen_completed  %}               <!-- -->
              <button data-tooltip='Request P200' data-p200-id='{{ agent.user_id }}' id='{{ agent.user_id }}_p200_button' class='button dark-blue small'>Request</button>    
            {% endif %}
          </td>
        </tr>
        {% endfor %}
        {% endif %}
        </tbody>
      </table>
  </div>
</div>

{% endblock %}
