{% extends 'base.html' %}
{% block content %}
<div class='overlay'>
  <div id='client-list'>
      <h2>Create A Client List</h2>
      <form action='' method='POST'>
        <input type='text' name='name' class='form-group' placeholder='Enter in the list name' />
        <button class='btn btn-success'>Create List</button>
      </form>
  </div>
</div>
<div class='row'>
  <div class='sidebar'>
    <div class='inner'>
      <ul>
        <li><a href='/dashboard'><span></span>New Prospects</a></li>
        <li><a href='/search'><span></span>Search</a></li>
        <li><a class='active' href='/clients'><span></span>Your Clients</a></li>
        <li><a href='/investor_profile'><span></span>Your Profile</a></li>
      </ul>
    </div>
  </div>
  <div class='items'>
    <div class='welcome'>
      <h1>Client List: {{ client_list.name }}<div class='pull-right'><a href=''><button id='export-list' class='btn btn-success'>Export With Contact Information</button></a></h1>
      <p>Add clients to a list to export, bulk email and track your performance.</p>
    </div>
    <div class='padding'>
      <table class="table table-striped table-hover ">
        {% if prospects %}
        <thead>
          <tr>
            <th>Include</th>
            <th>Name</th>
            <th>Current Company</th>
            <th>Current Title</th>
            <th>Current Industry</th>
            <th>Current Location</th>
          </tr>
        </thead>
        <tbody>
        {% for prospect in prospects %}
        <tr>
          <td><input type='checkbox' checked value='{{ prospect.id }}' class='prospect-checkbox' name='prospect' /></td>
          <td>{{ prospect.name }}</td>
          {% if prospect.current_job %}
          <td>{{ prospect.current_job.company.name }}</td>
          <td>{{ prospect.current_job.title }}</td>
          {% else %}
          <td>None</td>
          <td>None</td>
          {% endif %}
          <td>{{ prospect.industry_raw }}</td>
          <td>{{ prospect.location_raw }}</td>
        </tr>
        {% endfor %}
        {% else %}
        <tr>
          <td><h2 class='empty'>Go to the dashboard to add clients</h2></td>
        </tr>
        {% endif %}
        </tbody>
      </table>
      <div class='pagination'>
        {% if prospects %}
        <p>{% if prospects.has_prev %}<a href="{{ company.get_url }}?p={{ prospects.prev_num }}"><< Previous Page</a>{% endif %}
        {% if prospects.has_next %}<a href="{{ company.get_url }}?p={{ prospects.next_num }}">Next Page >></a>{% endif %}</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
<script src="/static/js/chart.js" type="text/javascript"></script>
<script src="//platform.linkedin.com/in.js" type="text/javascript"></script>
<script type='text/javascript'>

$(function() {
    $("#export-list").click(function(e) {
      e.preventDefault();
      exportList();
    });
});

function exportList() {
  var vals = []
  $(".prospect-checkbox:checked").each(function() {
      vals.push($(this).val())
  });
  var params={"ids": vals.join()}
  $.post("/export", params, function(data) {
      bootbox.alert("The export is being emailed to you");
  });
}

function showCreateForm() {
  $(".overlay").fadeIn();
}

</script>
{% endblock %}
